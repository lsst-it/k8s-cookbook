# yamllint disable-file
{{ range .Values.exports }}
---
apiVersion: ceph.rook.io/v1
kind: CephNFS
metadata:
  name: {{ .name }}
  namespace: rook-ceph
spec:
  rados:
    pool: {{ .pool }}
  server:
    active: 1
    resources:
      limits:
        cpu: "4"
        memory: 16Gi
      requests:
        cpu: "4"
        memory: 16Gi
---
apiVersion: v1
kind: Service
metadata:
  name: {{ .name }}
  namespace: rook-ceph
  annotations:
    metallb.universe.tf/loadBalancerIPs: {{ .ip }}
  labels:
    app: rook-ceph-nfs
    ceph_daemon_type: nfs
    ceph_nfs: {{ .name }}
    instance: a
    rook_cluster: rook-ceph
spec:
  ports:
    - name: nfs
      port: 2049
      protocol: TCP
      targetPort: 2049
  selector:
    app: rook-ceph-nfs
    ceph_daemon_type: nfs
    ceph_nfs: {{ .name }}
    instance: a
    rook_cluster: rook-ceph
  type: LoadBalancer
{{ end }}
