{
    "id": "firewall_logs_data_management",
    "policy": {
        "policy_id": "firewall_logs_data_management",
        "description": "Data management policy for the firewall logs.",
        "error_notification": null,
        "default_state": "new",
        "states": [
            {
                "name": "new",
                "actions": [
                    {
                        "retry": {
                            "count": 3,
                            "backoff": "exponential",
                            "delay": "1m"
                        },
                        "rollover": {
                            "min_size": "50gb",
                            "min_doc_count": 20000000,
                            "min_index_age": "1d",
                            "min_primary_shard_size": "25gb",
                            "copy_alias": false
                        }
                    }
                ],
                "transitions": [
                    {
                        "state_name": "downscale",
                        "conditions": {
                            "min_rollover_age": "1d"
                        }
                    }
                ]
            },
            {
                "name": "downscale",
                "actions": [
                    {
                        "retry": {
                            "count": 3,
                            "backoff": "exponential",
                            "delay": "1m"
                        },
                        "replica_count": {
                            "number_of_replicas": 0
                        }
                    }
                ],
                "transitions": [
                    {
                        "state_name": "delete",
                        "conditions": {
                            "min_rollover_age": "2d"
                        }
                    }
                ]
            },
            {
                "name": "delete",
                "actions": [
                    {
                        "retry": {
                            "count": 3,
                            "backoff": "exponential",
                            "delay": "1m"
                        },
                        "delete": {}
                    }
                ],
                "transitions": []
            }
        ],
        "ism_template": [
            {
                "index_patterns": [
                    "logs-firewall",
                    "logs-firewall-*",
                    ".ds-logs-firewall-*"
                ],
                "priority": 2
            }
        ]
    }
}
