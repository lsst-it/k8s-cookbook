---
defaultNamespace: &name fluent-bit-external
labels:
  bundle: *name
namespaceLabels:
  lsst.io/discover: "true"
kustomize:
  dir: base
  patches:
    - patch: |
        apiVersion: cert-manager.io/v1
        kind: Certificate
        metadata:
          name: rsyslog-cert
        spec:
          dnsNames:
            - rsyslog.fluent.${ get .ClusterLabels "management.cattle.io/cluster-display-name" }.${ get .ClusterLabels "site" }.lsst.org
helm:
  chart: &chart fluent-bit
  releaseName: *name
  repo: https://fluent.github.io/helm-charts
  version: 0.49.0
  timeoutSeconds: 600
  waitForJobs: true
  valuesFiles:
    - values.yaml
targetCustomizations:
  - name: kueyen
    clusterSelector:
      matchExpressions:
        - key: management.cattle.io/cluster-display-name
          operator: In
          values:
            - kueyen
    helm:
      valuesFiles:
        - overlays/kueyen/values.yaml
