---
auths:
  public_v1:
    version: 1
    community: "public"
  public_v2:
    version: 2
    community: "public"
  rubin_v1:
    version: 1
    community: "{{.snmpRubinCommunity}}"
  rubin_v2:
    version: 2
    community: "{{.snmpRubinCommunity}}"
  lsst_v1:
    version: 1
    community: "{{.snmpLsstCommunity}}"
  lsst_v2:
    version: 2
    community: "{{.snmpLsstCommunity}}"

modules:
  # Default IF-MIB interfaces table with ifIndex.
  if_mib:
    walk: [sysUpTime, interfaces, ifXTable]
    lookups:
      - source_indexes: [ifIndex]
        lookup: ifAlias
      - source_indexes: [ifIndex]
        # Uis OID to avoid conflict with PaloAlto PAN-COMMON-MIB.
        lookup: 1.3.6.1.2.1.2.2.1.2  # ifDescr
      - source_indexes: [ifIndex]
        # Use OID to avoid conflict with Netscaler NS-ROOT-MIB.
        lookup: 1.3.6.1.2.1.31.1.1.1.1  # ifName
    overrides:
      ifAlias:
        ignore: true  # Lookup metric
      ifDescr:
        ignore: true  # Lookup metric
      ifName:
        ignore: true  # Lookup metric
      ifType:
        type: EnumAsInfo
  # Default IP-MIB with ipv4InterfaceTable for example.
  ip_mib:
    walk: [ipv4InterfaceTable]

# Raritan
#
# https://cdn.raritan.com/download/PX/v1.5.20/PDU-MIB.txt
# https://cdn1.raritan.com/download/src-g2/4.0.20/PDU2_MIB_4.0.20_49038.txt
  raritan:
    walk:
      - 1.3.6.1.4.1.13742.4.1.20.2.1.7  # inletCurrent
      - 1.3.6.1.4.1.13742.4.1.20.2.1.8  # inletVoltage
      - 1.3.6.1.4.1.13742.4.1.20.2.1.9  # inletActivePower
      - 1.3.6.1.4.1.13742.4.1.2.2.1.31  # outletWattHours
      - 1.3.6.1.4.1.13742.4.1.2.2.1.3   # outletOperationalState
      - 1.3.6.1.4.1.13742.4.1.2.2.1.4   # outletCurrent
      - 1.3.6.1.4.1.13742.4.1.2.2.1.5   # outletMaxCurrent
      - 1.3.6.1.4.1.13742.4.1.2.2.1.6   # outletVoltage
      - 1.3.6.1.4.1.13742.4.1.2.2.1.7   # outletActivePower
      - 1.3.6.1.4.1.13742.4.1.3.1.5     # unitCpuTemp
      - 1.3.6.1.4.1.13742.6.5.5.3.1     # externalSensors
    lookups:
      - source_indexes: [outletIndex]
        lookup: outletLabel
    overrides:
      outletOperationalState:
        type: EnumAsStateSet

  xups:
    max_repetitions: 5
    walk:
      - xupsBatCapacity
      - xupsBatTimeRemaining
      - xupsBatVoltage
      - xupsBatCurrent
      - xupsEnvAmbientTemp
      - xupsInputTable
      - xupsInputVoltage
      - xupsInputFrequency
      - xupsOutputTable
      - xupsOutputVoltage
      - xupsOutputFrequency
      - xupsBypassTable
      - xupsBypassFrequency
      - xupsBatteryAbmStatus
    lookups:
      - source_indexes: [xupsInputTable]
        lookup: xupsInputVoltage
      - source_indexes: [xupsOutputTable]
        lookup: xupsOutputVoltage
      - source_indexes: [xupsBypassTable]
        lookup: xupsBypassFrequency
    filters:
      static:
        - targets:
            - xupsBatCapacity
            - xupsBatTimeRemaining
            - xupsBatVoltage
            - xupsBatCurrent
            - xupsEnvAmbientTemp
            - xupsInputVoltage
            - xupsInputFrequency
            - xupsOutputVoltage
            - xupsOutputFrequency
            - xupsBatteryAbmStatus
          indices: ["0"]
      # - 1.3.6.1.4.1.534.1.2.4      # xupsBatCapacity
      # - 1.3.6.1.4.1.534.1.2.1      # xupsBatTimeRemaining
      # - 1.3.6.1.4.1.534.1.2.2      # xupsBatVoltage
      # - 1.3.6.1.4.1.534.1.2.3      # xupsBatCurrent
      # - 1.3.6.1.4.1.534.1.6.1      # xupsEnvAmbientTemp
      # - 1.3.6.1.4.1.534.1.3.4      # xupsInputTable
      # - 1.3.6.1.4.1.534.1.3.4.1.2  # xupsInputVoltage
      # - 1.3.6.1.4.1.534.1.3.1      # xupsInputFrequency
      # - 1.3.6.1.4.1.534.1.4.4      # xupsOutputTable
      # - 1.3.6.1.4.1.534.1.4.4.1.2  # xupsOutputVoltage
      # - 1.3.6.1.4.1.534.1.4.2      # xupsOutputFrequency

  # due to the bad practice of the manufacturer, it labels all objects as a
  # DisplayString in the MIB. We need to override these to the correct data types
  # as gauges, counter, ...
  schneider_pm5xxx:
    walk:
      - midSerialNumber
      - vVan
      - vVbn
      - vVcn
      - vVab
      - vVbc
      - vVca
      - lcIa
      - lcIb
      - lcIC
      - lcIn
      - fFrequency
      - pActivePa
      - pActivePb
      - pActivePc
      - pReactivePa
      - pReactivePb
      - pReactivePc
      - pApparentPa
      - pApparentPb
      - pApparentPc
      - pfPfa
      - pfPfb
      - pfPfc
      - pfPfDisplacementA
      - pfPfDisplacementB
      - pfPfDisplacementC
      - pfPftot
      - pfPfDisplacementTotal
      - pActivePtot
      - pReactivePtot
      - pApparentPtot
      - aeActiveEDelivered
      - aeReactiveEDelivered
      - aeApparentEDelivered
      - aeResetDateTime
    overrides:
      vVan:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      vVbn:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      vVcn:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      vVab:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      vVbc:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      vVca:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      lcIa:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      lcIb:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      lcIC:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      lcIn:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      fFrequency:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pActivePa:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pActivePb:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pActivePc:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pReactivePa:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pReactivePb:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pReactivePc:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pApparentPa:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pApparentPb:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pApparentPc:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pfPfa:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pfPfb:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pfPfc:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pfPfDisplacementA:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pfPfDisplacementB:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pfPfDisplacementC:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pfPfDisplacementTotal:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pActivePtot:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pReactivePtot:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      pApparentPtot:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      aeActiveEDelivered:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      aeReactiveEDelivered:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      aeApparentEDelivered:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
      aeResetDateTime:
        regex_extracts:
          '':
            - regex: '(.*)'
              value: $1
  arista_bgp:
    walk:
      - aristaBgp4V2DiscontinuityTable
      - aristaBgp4V2DiscontinuityEntry
      - aristaBgp4V2DiscontinuityTime
      - aristaBgp4V2PeerTable
      - aristaBgp4V2PeerEntry
      - aristaBgp4V2PeerInstance
      - aristaBgp4V2PeerLocalAddrType
      - aristaBgp4V2PeerLocalAddr
      - aristaBgp4V2PeerRemoteAddrType
      - aristaBgp4V2PeerRemoteAddr
      - aristaBgp4V2PeerLocalPort
      - aristaBgp4V2PeerLocalAs
      - aristaBgp4V2PeerLocalIdentifier
      - aristaBgp4V2PeerRemotePort
      - aristaBgp4V2PeerRemoteAs
      - aristaBgp4V2PeerRemoteIdentifier
      - aristaBgp4V2PeerAdminStatus
      - aristaBgp4V2PeerState
      - aristaBgp4V2PeerDescription
      - aristaBgp4V2PeerPrevState
      - aristaBgp4V2PeerErrorsTable
      - aristaBgp4V2PeerErrorsEntry
      - aristaBgp4V2PeerLastErrorCodeReceived
      - aristaBgp4V2PeerLastErrorSubCodeReceived
      - aristaBgp4V2PeerLastErrorReceivedTime
      - aristaBgp4V2PeerLastErrorReceivedText
      - aristaBgp4V2PeerLastErrorReceivedData
      - aristaBgp4V2PeerLastErrorCodeSent
      - aristaBgp4V2PeerLastErrorSubCodeSent
      - aristaBgp4V2PeerLastErrorSentTime
      - aristaBgp4V2PeerLastErrorSentText
      - aristaBgp4V2PeerLastErrorSentData
      - aristaBgp4V2PeerEventTimesTable
      - aristaBgp4V2PeerEventTimesEntry
      - aristaBgp4V2PeerFsmEstablishedTime
      - aristaBgp4V2PeerInUpdatesElapsedTime
      - aristaBgp4V2PeerConfiguredTimersTable
      - aristaBgp4V2PeerConfiguredTimersEntry
      - aristaBgp4V2PeerConnectRetryInterval
      - aristaBgp4V2PeerHoldTimeConfigured
      - aristaBgp4V2PeerKeepAliveConfigured
      - aristaBgp4V2PeerMinASOrigInterval
      - aristaBgp4V2PeerMinRouteAdverInterval
      - aristaBgp4V2PeerNegotiatedTimersTable
      - aristaBgp4V2PeerNegotiatedTimersEntry
      - aristaBgp4V2PeerHoldTime
      - aristaBgp4V2PeerKeepAlive
      - aristaBgp4V2PeerCountersTable
      - aristaBgp4V2PeerCountersEntry
      - aristaBgp4V2PeerInUpdates
      - aristaBgp4V2PeerOutUpdates
      - aristaBgp4V2PeerInTotalMessages
      - aristaBgp4V2PeerOutTotalMessages
      - aristaBgp4V2PeerFsmEstablishedTransitions
      - aristaBgp4V2PrefixGaugesTable
      - aristaBgp4V2PrefixGaugesEntry
      - aristaBgp4V2PrefixGaugesAfi
      - aristaBgp4V2PrefixGaugesSafi
      - aristaBgp4V2PrefixInPrefixes
      - aristaBgp4V2PrefixInPrefixesAccepted
      - aristaBgp4V2PrefixOutPrefixes
      - aristaBgp4V2NlriTable
      - aristaBgp4V2NlriEntry
      - aristaBgp4V2NlriIndex
      - aristaBgp4V2NlriAfi
      - aristaBgp4V2NlriSafi
      - aristaBgp4V2NlriPrefixType
      - aristaBgp4V2NlriPrefix
      - aristaBgp4V2NlriPrefixLen
      - aristaBgp4V2NlriBest
      - aristaBgp4V2NlriCalcLocalPref
      - aristaBgp4V2NlriOrigin
      - aristaBgp4V2NlriNextHopAddrType
      - aristaBgp4V2NlriNextHopAddr
      - aristaBgp4V2NlriLinkLocalNextHopAddrType
      - aristaBgp4V2NlriLinkLocalNextHopAddr
      - aristaBgp4V2NlriLocalPrefPresent
      - aristaBgp4V2NlriLocalPref
      - aristaBgp4V2NlriMedPresent
      - aristaBgp4V2NlriMed
      - aristaBgp4V2NlriAtomicAggregate
      - aristaBgp4V2NlriAggregatorPresent
      - aristaBgp4V2NlriAggregatorAS
      - aristaBgp4V2NlriAggregatorAddr
      - aristaBgp4V2NlriAsPathCalcLength
      - aristaBgp4V2NlriAsPathString
      - aristaBgp4V2NlriAsPath
      - aristaBgp4V2NlriPathAttrUnknown
      - aristaBgp4V2AdjRibsOutTable
      - aristaBgp4V2AdjRibsOutEntry
      - aristaBgp4V2AdjRibsOutIndex
      - aristaBgp4V2AdjRibsOutRoute
      - aristaBgp4V2PrefixEvpnNlriGaugesTable
      - aristaBgp4V2PrefixEvpnNlriGaugesEntry
      - aristaBgp4V2PrefixGaugesNlri
      - aristaBgp4V2PrefixNlriInPrefixes
      - aristaBgp4V2PrefixNlriInPrefixesAccepted
